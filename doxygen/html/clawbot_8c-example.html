<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Convex: clawbot.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" class="pageheader">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="convex_logo.png"/></td>
  <td width="100%" align="center" valign="bottom"></td>
  <td align="right"></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('clawbot_8c-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">clawbot.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>An example that controls the VEX clawbot</p>
<div class="fragment"><div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*                        Copyright (c) James Pearman                          */</span></div>
<div class="line"><span class="comment">/*                                   2013                                      */</span></div>
<div class="line"><span class="comment">/*                            All Rights Reserved                              */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    Module:     clawbot.c                                                    */</span></div>
<div class="line"><span class="comment">/*    Author:     James Pearman                                                */</span></div>
<div class="line"><span class="comment">/*    Created:    18 June 2013                                                 */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    Revisions:                                                               */</span></div>
<div class="line"><span class="comment">/*                V1.00  04 July 2013 - Initial release                        */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    The author is supplying this software for use with the VEX cortex        */</span></div>
<div class="line"><span class="comment">/*    control system. This file can be freely distributed and teams are        */</span></div>
<div class="line"><span class="comment">/*    authorized to freely use this program , however, it is requested that    */</span></div>
<div class="line"><span class="comment">/*    improvements or additions be shared with the Vex community via the vex   */</span></div>
<div class="line"><span class="comment">/*    forum.  Please acknowledge the work of the authors when appropriate.     */</span></div>
<div class="line"><span class="comment">/*    Thanks.                                                                  */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);          */</span></div>
<div class="line"><span class="comment">/*    you may not use this file except in compliance with the License.         */</span></div>
<div class="line"><span class="comment">/*    You may obtain a copy of the License at                                  */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*      http://www.apache.org/licenses/LICENSE-2.0                             */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    Unless required by applicable law or agreed to in writing, software      */</span></div>
<div class="line"><span class="comment">/*    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,        */</span></div>
<div class="line"><span class="comment">/*    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. */</span></div>
<div class="line"><span class="comment">/*    See the License for the specific language governing permissions and      */</span></div>
<div class="line"><span class="comment">/*    limitations under the License.                                           */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*    The author can be contacted on the vex forums as jpearman                */</span></div>
<div class="line"><span class="comment">/*    or electronic mail using jbpearman_at_mac_dot_com                        */</span></div>
<div class="line"><span class="comment">/*    Mentor for team 8888 RoboLancers, Pasadena CA.                           */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*   Clawbot demo code                                                         */</span></div>
<div class="line"><span class="comment">/*   A port of the robotc clawbot code                                         */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;ch.h&quot;</span>         <span class="comment">// needs for all ChibiOS programs</span></div>
<div class="line"><span class="preprocessor">#include &quot;hal.h&quot;</span>        <span class="comment">// hardware abstraction layer header</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="vex_8h.html" title="Main vex include file. ">vex.h</a>&quot;</span>        <span class="comment">// vex library header</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="smartmotor_8h.html" title="A port of the smart motor library for ChibiOS/RT, header. ">smartmotor.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="robotc__glue_8h.html" title="Header for ROBOTC glue functions. ">robotc_glue.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;clawbot.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span><span class="comment"></span></div>
<div class="line"><span class="comment">/** @file    clawbot.c</span></div>
<div class="line"><span class="comment">  * @brief   Clawbot demo code</span></div>
<div class="line"><span class="comment">*/</span><span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">/** @example clawbot.c</span></div>
<div class="line"><span class="comment"> *  An example that controls the VEX clawbot</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Digi IO configuration</span></div>
<div class="line"><span class="keyword">static</span>  <a name="_a0"></a><a class="code" href="struct__vex_digi_cfg.html" title="Structure holding information to configure a single digital pin. ">vexDigiCfg</a>  dConfig[<a name="a1"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa0e2a18a531167e135b4653178524cd91">kVexDigital_Num</a>] = {</div>
<div class="line">        { <a name="a2"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa27e083484055f31332aec40678df19a4">kVexDigital_1</a>,    <a name="a3"></a><a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eab9e8c93ae679bcd6d2420d0e35617b99">kVexSensorDigitalOutput</a>, <a name="a4"></a><a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030af55432775c56d47d7b134318b5d39953">kVexConfigOutput</a>,      0 },</div>
<div class="line">        { <a name="a5"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa19d1e6c7d95fdd0ce19e5d3652834f18">kVexDigital_2</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eab9e8c93ae679bcd6d2420d0e35617b99">kVexSensorDigitalOutput</a>, <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030af55432775c56d47d7b134318b5d39953">kVexConfigOutput</a>,      0 },</div>
<div class="line">        { <a name="a6"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caafa33d88f0d0b4017489909f832bf7386">kVexDigital_3</a>,    <a name="a7"></a><a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a name="a8"></a><a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a9"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa6e1e3afb14785474cf7517d4aecb5f5c">kVexDigital_4</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a10"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa0042c537243ac44fb946dae83ddd673e">kVexDigital_5</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a11"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa8604e89c472fbbac265d523ec92f1c01">kVexDigital_6</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a12"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa168fac9aead75d6896b151de8796d4fe">kVexDigital_7</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a13"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caaa4af5b1436fcfdb32c2d99044cd2b44a">kVexDigital_8</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a14"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa29ce66105594a8f2017a9047d35ae036">kVexDigital_9</a>,    <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a15"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa7f828b72d0b2a2b16cd482e64356d109">kVexDigital_10</a>,   <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a16"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caa25c71d7fa21ab08684710b2a8cf22d71">kVexDigital_11</a>,   <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 },</div>
<div class="line">        { <a name="a17"></a><a class="code" href="vexdigital_8h.html#ada6c474f1f434058485c115c087767caade7b7acc0a0e38026df43efb4319bdd7">kVexDigital_12</a>,   <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99eac2c347eea15524a9c219f828478c4768">kVexSensorDigitalInput</a>,  <a class="code" href="vexconfig_8h.html#ae48462eaf90683d1b2da2b107286c030a92e50d449111a666240dbfc31001ee83">kVexConfigInput</a>,       0 }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span>  <a name="_a18"></a><a class="code" href="struct__vex_motor_cfg.html" title="Structure holding information to configure a single motor. ">vexMotorCfg</a> mConfig[10] = {</div>
<div class="line">        { <a name="a19"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97a5554846dcf0617d679eb255548d05dd8">kVexMotor_1</a>,      <a name="a20"></a><a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819a93027887fea781a9f4dbc5fb618fc8a4">kVexMotor393T</a>,          <a name="a21"></a><a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a name="a22"></a><a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea6362096d5697a6523409e03f3de0bfa9">kVexSensorIME</a>,         <a name="a23"></a><a class="code" href="vexime_8h.html#ac3f48915e83bb314828cdda02c197cf3a54f6de3e7c9ee9f8debcbcecb83611e9">kImeChannel_1</a> },</div>
<div class="line">        { <a name="a24"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97a8c3b9e36a7a245882bd5fbff60aa11dd">kVexMotor_2</a>,      <a name="a25"></a><a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a name="a26"></a><a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a27"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97af83dc9ed5e5e18d41cf936628e0c3c5a">kVexMotor_3</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a28"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97ad6e09eab140b8bc4e0fd4f2abff869b4">kVexMotor_4</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a29"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97a10b724b72882b09e48c351ff974a6927">kVexMotor_5</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a30"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97aa11f5074137521a2450b781ea92743c7">kVexMotor_6</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a31"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97aec66aedd7e2313ee87969e687a59f5a3">kVexMotor_7</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819affb153e903c4081ca22d1ac404c8b2c9">kVexMotorUndefined</a>,     <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a32"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97abffe6fad2cf547c557a6e388b39fb9e3">kVexMotor_8</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819a93027887fea781a9f4dbc5fb618fc8a4">kVexMotor393T</a>,          <a name="a33"></a><a class="code" href="vexmotor_8h.html#a1b37a85fe25cfbd0ffb963aacb406b40" title="Motor command causes reversed movement. ">kVexMotorReversed</a>,     <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea83e036de1aff6a73a5be31694dc46064">kVexSensorNone</a>,        0 },</div>
<div class="line">        { <a name="a34"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97ae3e5df98c282d1d31cedbe512b32066d">kVexMotor_9</a>,      <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819a93027887fea781a9f4dbc5fb618fc8a4">kVexMotor393T</a>,          <a class="code" href="vexmotor_8h.html#a92ed076752a09f9118679a31d4a60ea2" title="Motor command causes normal movement. ">kVexMotorNormal</a>,       <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea6362096d5697a6523409e03f3de0bfa9">kVexSensorIME</a>,         <a name="a35"></a><a class="code" href="vexime_8h.html#ac3f48915e83bb314828cdda02c197cf3a5b2deecabf2f2e2301784a27fec5e677">kImeChannel_3</a> },</div>
<div class="line">        { <a name="a36"></a><a class="code" href="vexmotor_8h.html#a1233a4fb09fef02c962ccec318e00c97a55aab9faf3619870d88cbe2e5ca5da54">kVexMotor_10</a>,     <a class="code" href="vexmotor_8h.html#a62170b45bb8b2b6c66889914eb602819a93027887fea781a9f4dbc5fb618fc8a4">kVexMotor393T</a>,          <a class="code" href="vexmotor_8h.html#a1b37a85fe25cfbd0ffb963aacb406b40" title="Motor command causes reversed movement. ">kVexMotorReversed</a>,     <a class="code" href="vexconfig_8h.html#af55a7bef7693498b6964f850b0efe99ea6362096d5697a6523409e03f3de0bfa9">kVexSensorIME</a>,         <a name="a37"></a><a class="code" href="vexime_8h.html#ac3f48915e83bb314828cdda02c197cf3aa731d67bf5df6a2b88b9b0d3004a92cf">kImeChannel_2</a> }</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MotorDriveR     kVexMotor_1</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define MotorArm        kVexMotor_8</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define MotorClaw       kVexMotor_9</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define MotorDriveL     kVexMotor_10</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define armPot          kVexAnalog_1</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define clawPot         kVexAnalog_2</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Drive control task                                                         */</span></div>
<div class="line"><span class="comment">/*                                                                             */</span></div>
<div class="line"><span class="comment">/*  Uses joystick Ch3, Ch4                                                     */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a name="a38"></a><a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( <span class="keywordtype">short</span> forward, <span class="keywordtype">short</span> turn )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">long</span> drive_l_motor;</div>
<div class="line">    <span class="keywordtype">long</span> drive_r_motor;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set drive</span></div>
<div class="line">    drive_l_motor = forward + turn;</div>
<div class="line">    drive_r_motor = forward - turn;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// normalize drive so max is 127 if any drive is over 127</span></div>
<div class="line">    <span class="keywordtype">int</span> max = abs(drive_l_motor);</div>
<div class="line">    <span class="keywordflow">if</span> (abs(drive_r_motor)  &gt; max)</div>
<div class="line">        max = abs(drive_r_motor);</div>
<div class="line">    <span class="keywordflow">if</span> (max&gt;127) {</div>
<div class="line">        drive_l_motor = 127 * drive_l_motor / max;</div>
<div class="line">        drive_r_motor = 127 * drive_r_motor  / max;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Send to motors</span></div>
<div class="line">    <span class="comment">// left drive</span></div>
<div class="line">    <a name="a39"></a><a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a name="a40"></a><a class="code" href="clawbot_8c.html#ab66d2d0d3475eb13037a2b88d60b3171">MotorDriveL</a>, drive_l_motor);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// right drive</span></div>
<div class="line">    <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a name="a41"></a><a class="code" href="clawbot_8c.html#a537d70a24114f13e3f327ea83087d105">MotorDriveR</a>, drive_r_motor);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Drive control task                                                         */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="robotc__glue_8h.html#a8bc22769f445ed91abfcbac376dea14d" title="ROBOTC &quot;tasks&quot; return type task. ">task</a></div>
<div class="line"><a name="a42"></a><a class="code" href="clawbot_8c.html#a8c9c7298c1061a2987f1fb051cf50168">DriveTask</a>(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">short</span>   forward, turn;</div>
<div class="line"></div>
<div class="line">    (void)arg;</div>
<div class="line">    <a name="a43"></a><a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;Drive task&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">        <span class="comment">// Get controller</span></div>
<div class="line">        <span class="keywordflow">if</span>( abs( <a name="a44"></a><a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a45"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749aa3a430b4eaea3d476f941d1a774a457f">Ch3</a> ) ) &gt; 10 )</div>
<div class="line">            forward = <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749aa3a430b4eaea3d476f941d1a774a457f">Ch3</a> );</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            forward = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>( abs( <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a46"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749a1dfd6e5a895e9ccf858531bb01b91e61">Ch4</a> ) ) &gt; 10 )</div>
<div class="line">            turn = <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749a1dfd6e5a895e9ccf858531bb01b91e61">Ch4</a> );</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            turn = 0;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( forward, turn );</div>
<div class="line"></div>
<div class="line">        <a name="a47"></a><a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(25);</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Arm control                                                                */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Global to hold requested (target) arm position</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span>  armRequestedValue;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Arm limits</span></div>
<div class="line"><span class="preprocessor">#define ARM_UPPER_LIMIT     2000</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ARM_LOWER_LIMIT      600</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define ARM_PRESET_H        2000</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ARM_PRESET_L         650</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Set requested arm position and clip to limits                              */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">SetArmPosition( <span class="keywordtype">int</span> position )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// crude limiting to upper and lower values</span></div>
<div class="line">    <span class="keywordflow">if</span>( position &gt; <a name="a48"></a><a class="code" href="clawbot_8c.html#a17baa2768649001c6541fe857f81803a">ARM_UPPER_LIMIT</a> )</div>
<div class="line">        armRequestedValue = <a class="code" href="clawbot_8c.html#a17baa2768649001c6541fe857f81803a">ARM_UPPER_LIMIT</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">if</span>( position &lt; <a name="a49"></a><a class="code" href="clawbot_8c.html#a6029dbd13a99d6e58a8eb59c251a15c2">ARM_LOWER_LIMIT</a> )</div>
<div class="line">        armRequestedValue = <a class="code" href="clawbot_8c.html#a6029dbd13a99d6e58a8eb59c251a15c2">ARM_LOWER_LIMIT</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        armRequestedValue = position;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Get requested arm position                                                 */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">GetArmPosition(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span>( armRequestedValue );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  arm pid (actually just P) control task                                     */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="robotc__glue_8h.html#a8bc22769f445ed91abfcbac376dea14d" title="ROBOTC &quot;tasks&quot; return type task. ">task</a> <a name="a50"></a><a class="code" href="clawbot_8c.html#ae04c9b449a0e608607e7de56560a607d">ArmPidController</a>(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">           <span class="keywordtype">int</span>    armSensorCurrentValue;</div>
<div class="line">           <span class="keywordtype">int</span>    armError;</div>
<div class="line">           <span class="keywordtype">float</span>  armDrive;</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">float</span>  pid_K = 0.3;</div>
<div class="line"></div>
<div class="line">    (void)arg;</div>
<div class="line">    <a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;arm pid&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>( <span class="keyword">true</span> )</div>
<div class="line">        {</div>
<div class="line">        <span class="comment">// Read the sensor value and scale</span></div>
<div class="line">        armSensorCurrentValue = <a name="a51"></a><a class="code" href="vexanalog_8c.html#a0775fe9e40f3c2ca30e0dd3b3b33a547" title="Return ADC sample from sample buffer. ">vexAdcGet</a>( <a name="a52"></a><a class="code" href="clawbot_8c.html#a9ca928b8adf20ef8785cafafd35057b8">armPot</a> );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// calculate error</span></div>
<div class="line">        armError =  armRequestedValue - armSensorCurrentValue;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// calculate drive</span></div>
<div class="line">        armDrive = (pid_K * (float)armError);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// limit drive</span></div>
<div class="line">        <span class="keywordflow">if</span>( armDrive &gt; 127 )</div>
<div class="line">            armDrive = 127;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>( armDrive &lt; (-127) )</div>
<div class="line">            armDrive = (-127);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// send to motor</span></div>
<div class="line">        <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a name="a53"></a><a class="code" href="clawbot_8c.html#a9942eddf4858da64014f5791e3398596">MotorArm</a>, armDrive);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Don&#39;t hog cpu</span></div>
<div class="line">        <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>( 25 );</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Claw control code                                                          */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">    <a name="a54"></a><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca585e44fff7d0e674a35fd0c1472b082d">kClawNoCommand</a> = 0,</div>
<div class="line">    <a name="a55"></a><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca13d81dc0e46ee5017f25df55037016e5">kClawOpenCommand</a>,</div>
<div class="line">    <a name="a56"></a><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecacaa65d76ac970734646cba449cedb4798b">kClawCloseCommand</a>,</div>
<div class="line">    <a name="a57"></a><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca06d4c2255b860de62fcf9e96b1e6a473">kClawStopCommand</a></div>
<div class="line">    } <a name="a58"></a><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecac">clawCommand</a>;</div>
<div class="line"></div>
<div class="line"><a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecac">clawCommand</a> <a name="a59"></a><a class="code" href="clawbot_8c.html#acb808e65d5becfd0cfd046c701025148">clawCmd</a> = <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca585e44fff7d0e674a35fd0c1472b082d">kClawNoCommand</a>;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define CLAW_OPEN_HIGH_SPEED      80</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLAW_CLOSE_HIGH_SPEED    -80</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLAW_OPEN_LOW_SPEED       20</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLAW_CLOSE_LOW_SPEED     -15</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Run the claw motor in the close direction                                  */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ClawClose(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    clawCmd = <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecacaa65d76ac970734646cba449cedb4798b">kClawCloseCommand</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Run the claw motor in the open direction                                   */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ClawOpen(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    clawCmd = <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca13d81dc0e46ee5017f25df55037016e5">kClawOpenCommand</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Stop claw motor                                                            */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">ClawStop(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    clawCmd = <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca06d4c2255b860de62fcf9e96b1e6a473">kClawStopCommand</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Task to control the claw motors                                            */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="robotc__glue_8h.html#a8bc22769f445ed91abfcbac376dea14d" title="ROBOTC &quot;tasks&quot; return type task. ">task</a> <a name="a60"></a><a class="code" href="clawbot_8c.html#a9ba10b2c7acecff4397d113f009a145b">ClawController</a>(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span>     hold_delay = 0;</div>
<div class="line"></div>
<div class="line">    (void)arg;</div>
<div class="line">    <a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;claw control&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">        <span class="keywordflow">switch</span>( clawCmd )</div>
<div class="line">            {</div>
<div class="line">            <span class="keywordflow">case</span>    <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca13d81dc0e46ee5017f25df55037016e5">kClawOpenCommand</a>:</div>
<div class="line">                <span class="comment">// look for fully open (around 500 counts)</span></div>
<div class="line">                <span class="keywordflow">if</span>( <a name="a61"></a><a class="code" href="vexmotor_8c.html#acc17a38d114df67353cacb87fa8c38bc" title="Get the current motor position. ">vexMotorPositionGet</a>( <a name="a62"></a><a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ) &gt; 400 )</div>
<div class="line">                    <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ,  <a name="a63"></a><a class="code" href="clawbot_8c.html#a3b6c6eda71abbffcf655649282941a0d">CLAW_OPEN_LOW_SPEED</a>);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ,  <a name="a64"></a><a class="code" href="clawbot_8c.html#aec87aba8d7935ee17692e4d1b3eef299">CLAW_OPEN_HIGH_SPEED</a>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span>    <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecacaa65d76ac970734646cba449cedb4798b">kClawCloseCommand</a>:</div>
<div class="line">                <span class="comment">// look for fully closed (enc == 0)</span></div>
<div class="line">                <span class="keywordflow">if</span>( <a class="code" href="vexmotor_8c.html#acc17a38d114df67353cacb87fa8c38bc" title="Get the current motor position. ">vexMotorPositionGet</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ) &lt; 100 )</div>
<div class="line">                    <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> , <a name="a65"></a><a class="code" href="clawbot_8c.html#a88ba0f745d088c2428fb1b93f78b8925">CLAW_CLOSE_LOW_SPEED</a>);</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                    <span class="comment">// This test checks for slow motor movement when partially closed</span></div>
<div class="line">                    <span class="comment">// half second delay before check starts</span></div>
<div class="line">                    <span class="keywordflow">if</span>(hold_delay++ &gt; 20)</div>
<div class="line">                        {</div>
<div class="line">                        <span class="keywordflow">if</span>( <a name="a66"></a><a class="code" href="smartmotor_8c.html#a508729e7582e59f5fcfc5c85d0fcb644" title="Get Motor speed. ">SmartMotorGetSpeed</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ) &gt; -40 )</div>
<div class="line">                            <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> , <a class="code" href="clawbot_8c.html#a88ba0f745d088c2428fb1b93f78b8925">CLAW_CLOSE_LOW_SPEED</a>);</div>
<div class="line">                        }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> , <a name="a67"></a><a class="code" href="clawbot_8c.html#ae2f1957e0bf814ea229b801add3f2c03">CLAW_CLOSE_HIGH_SPEED</a> );</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                <span class="comment">// learn minimum encoder position</span></div>
<div class="line">                <span class="keywordflow">if</span>( <a class="code" href="vexmotor_8c.html#acc17a38d114df67353cacb87fa8c38bc" title="Get the current motor position. ">vexMotorPositionGet</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ) &lt; 0 )</div>
<div class="line">                    <a name="a68"></a><a class="code" href="vexmotor_8c.html#a3197e2895bccfed36934669d8c82b97f" title="Set the current motor position. ">vexMotorPositionSet</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a>, 0);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span>    <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca06d4c2255b860de62fcf9e96b1e6a473">kClawStopCommand</a>:</div>
<div class="line">                <a class="code" href="smartmotor_8h.html#a4d52a5e1754962a59621bf8aa897b4b4">SetMotor</a>( <a class="code" href="clawbot_8c.html#a4223e616f3c2d89b6d9497e5233adbfb">MotorClaw</a> ,  0 );</div>
<div class="line">                clawCmd = <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecaca585e44fff7d0e674a35fd0c1472b082d">kClawNoCommand</a>;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// reset hold delay</span></div>
<div class="line">        <span class="keywordflow">if</span>(clawCmd != <a class="code" href="clawbot_8c.html#af713754742ccc19f3b43dbc6f4aeecacaa65d76ac970734646cba449cedb4798b">kClawCloseCommand</a>)</div>
<div class="line">            hold_delay = 0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Don&#39;t hog cpu</span></div>
<div class="line">        <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(25);</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="comment">/*  Task to control arm (and claw) movement                                    */</span></div>
<div class="line"><span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="robotc__glue_8h.html#a8bc22769f445ed91abfcbac376dea14d" title="ROBOTC &quot;tasks&quot; return type task. ">task</a></div>
<div class="line"><a name="a69"></a><a class="code" href="clawbot_8c.html#a1fe3071e2c14528266e98eac97fc32cf">ManualArmClawTask</a>(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    (void)arg;</div>
<div class="line">    <a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;manual arm&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// initialize</span></div>
<div class="line">    SetArmPosition( <a class="code" href="vexanalog_8c.html#a0775fe9e40f3c2ca30e0dd3b3b33a547" title="Return ADC sample from sample buffer. ">vexAdcGet</a>( <a class="code" href="clawbot_8c.html#a9ca928b8adf20ef8785cafafd35057b8">armPot</a> ) );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// use joystick to modify the requested position</span></div>
<div class="line">    <span class="keywordflow">while</span>( <span class="keyword">true</span> )</div>
<div class="line">        {</div>
<div class="line">        <span class="comment">// presets - assume joystick is centered</span></div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a70"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749aaa257caa7f6770d095adb6c42e0265ce">Btn8U</a> ) == 1 )</div>
<div class="line">            SetArmPosition( <a name="a71"></a><a class="code" href="clawbot_8c.html#aabe6201c2a391f2d3eabfe16a41e19e0">ARM_PRESET_H</a> );</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a72"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749adef9c849b9fca8450ff5b36a4fe12c87">Btn8D</a> ) == 1 )</div>
<div class="line">            SetArmPosition( <a name="a73"></a><a class="code" href="clawbot_8c.html#a21551f710178f5366694503f4b8fe4e2">ARM_PRESET_L</a> );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// manual control</span></div>
<div class="line">        <span class="keywordflow">if</span>( abs(<a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a74"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749a493a19d3b8dacee89022961f61771579">Ch2</a> )) &gt; 15 )</div>
<div class="line">            SetArmPosition( GetArmPosition() + (<a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749a493a19d3b8dacee89022961f61771579">Ch2</a> )) );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Claw control</span></div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a75"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749a1a6a1fb7ecd72443e41c21d41c7b117f">Btn6D</a> ) == 1 )</div>
<div class="line">            ClawOpen();</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>( <a class="code" href="vexctl_8c.html#a347b97c527e51e3bf3a389bc8a809077" title="Get controller data. ">vexControllerGet</a>( <a name="a76"></a><a class="code" href="vexctl_8h.html#a5715c53d995bf45c042a6bbf07e62749af824d1c21f732b81096715aadb0bc33e">Btn6U</a> ) == 1 )</div>
<div class="line">            ClawClose();</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            ClawStop();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// don&#39;t hog cpu</span></div>
<div class="line">        <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(50);</div>
<div class="line">        }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// Initialize the digital ports</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a name="a77"></a><a class="code" href="vex_8h.html#ac5b7557d665fb6e6dc124f8f891f9a0b" title="User setup. ">vexUserSetup</a>()</div>
<div class="line">{</div>
<div class="line">    <a name="a78"></a><a class="code" href="vexconfig_8c.html#a608da14379df1633fcd2c6df094b70a6" title="Configure digital ports. ">vexDigitalConfigure</a>( dConfig, <a name="a79"></a><a class="code" href="vexconfig_8h.html#a103b9b0db8b2635593c1646e6cb2b164" title="Macro to calculate the number of entries in digital config. ">DIG_CONFIG_SIZE</a>( dConfig ) );</div>
<div class="line">    <a name="a80"></a><a class="code" href="vexconfig_8c.html#a35900825ff1e1c740970f6ef661b504a" title="Configure motors based on a configuration structure. ">vexMotorConfigure</a>( mConfig, <a name="a81"></a><a class="code" href="vexconfig_8h.html#aa6fcca7312aedc8d8cb565721fb84c6b" title="Macro to calculate the number of entries in motor config. ">MOT_CONFIG_SIZE</a>( mConfig ) );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// called before either autonomous or user control</span></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a name="a82"></a><a class="code" href="vex_8h.html#a8817d8150444d94744f9771725acc712" title="User initialize. ">vexUserInit</a>()</div>
<div class="line">{</div>
<div class="line">    <a name="a83"></a><a class="code" href="smartmotor_8c.html#a2be3709e56aca10845831edf10907f8b" title="Initialize the smartMotor library. ">SmartMotorsInit</a>();</div>
<div class="line">    <a name="a84"></a><a class="code" href="smartmotor_8c.html#a020fdcd1790e710d138e7d61b7e0dd37" title="Enable current limit by using a preset threshold. ">SmartMotorCurrentMonitorEnable</a>();</div>
<div class="line">    <a name="a85"></a><a class="code" href="smartmotor_8c.html#aab976ab79d0bf527bbf7fa07e443fb42" title="Start the smart motor monitoring. ">SmartMotorRun</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Autonomous control task</span></div>
<div class="line">msg_t</div>
<div class="line"><a name="a86"></a><a class="code" href="vex_8h.html#a287b65e0518551afca65e5b7b19a44d9" title="Autonomous. ">vexAutonomous</a>( <span class="keywordtype">void</span> *arg )</div>
<div class="line">{</div>
<div class="line">    (void)arg;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Must call this</span></div>
<div class="line">    <a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;auton&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// start the Arm PID task</span></div>
<div class="line">    <a name="a87"></a><a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#ae04c9b449a0e608607e7de56560a607d">ArmPidController</a> );</div>
<div class="line">    <span class="comment">// start the claw motor controller</span></div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#a9ba10b2c7acecff4397d113f009a145b">ClawController</a> );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Arm Up</span></div>
<div class="line">    SetArmPosition( 2000 );</div>
<div class="line">    <span class="comment">// Claw Open</span></div>
<div class="line">    ClawOpen();</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(2000);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Move forward</span></div>
<div class="line">    <a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( 100, 0 );</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(1000);</div>
<div class="line">    <span class="comment">// Stop drivw</span></div>
<div class="line">    <a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( 0, 0 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Arm down</span></div>
<div class="line">    SetArmPosition( 700 );</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(2000);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// close claw</span></div>
<div class="line">    ClawClose();</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(1000);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Arm up</span></div>
<div class="line">    SetArmPosition( 1000 );</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(1000);</div>
<div class="line">    <span class="comment">// Turn</span></div>
<div class="line">    <a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( 0, 100 );</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(1000);</div>
<div class="line">    <span class="comment">// Stop drivw</span></div>
<div class="line">    <a class="code" href="clawbot_8c.html#a52cd4c4301b325654eeb8d3f6a3c1f0e">DriveSystemArcadeDrive</a>( 0, 0 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Claw Open</span></div>
<div class="line">    ClawOpen();</div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#a772c899f95d918afe02f3201f3e4e219" title="delay compatibility shortcut ">wait1Msec</a>(1000);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Stop claw motor</span></div>
<div class="line">    ClawStop();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">        <span class="comment">// Don&#39;t hog cpu</span></div>
<div class="line">        <a name="a88"></a><a class="code" href="vex_8h.html#a0069824f3952a61165be297146701489" title="Sleep for given number of ms. ">vexSleep</a>( 25 );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> (msg_t)0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Driver control task</span></div>
<div class="line">msg_t</div>
<div class="line"><a name="a89"></a><a class="code" href="vex_8h.html#a2a32915075b519dbc7c34af7f2e16c46" title="Driver control. ">vexOperator</a>( <span class="keywordtype">void</span> *arg )</div>
<div class="line">{</div>
<div class="line">    (void)arg;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Must call this</span></div>
<div class="line">    <a class="code" href="vex_8h.html#a08847f8db8d168c4f8acad495beda363" title="Register a thread so it can be terminated during vexSleep. ">vexTaskRegister</a>(<span class="stringliteral">&quot;operator&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start manual driving</span></div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#a8c9c7298c1061a2987f1fb051cf50168">DriveTask</a> );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// start the Arm PID task</span></div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#ae04c9b449a0e608607e7de56560a607d">ArmPidController</a> );</div>
<div class="line">    <span class="comment">// start the claw motor controller</span></div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#a9ba10b2c7acecff4397d113f009a145b">ClawController</a> );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// start manual arm/claw control</span></div>
<div class="line">    <a class="code" href="robotc__glue_8h.html#af4543c25ec70dbf7d2d11dd3971c61e7" title="Macro to simulate the ROBOTC StartTask function. ">StartTask</a>( <a class="code" href="clawbot_8c.html#a1fe3071e2c14528266e98eac97fc32cf">ManualArmClawTask</a> );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Run until asked to terminate</span></div>
<div class="line">    <span class="keywordflow">while</span>(!chThdShouldTerminate())</div>
<div class="line">        {</div>
<div class="line">        <span class="comment">// Don&#39;t hog cpu</span></div>
<div class="line">        <a class="code" href="vex_8h.html#a0069824f3952a61165be297146701489" title="Sleep for given number of ms. ">vexSleep</a>( 25 );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> (msg_t)0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Jan 5 2014 15:43:37 for Convex by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
